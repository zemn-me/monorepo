{
	"$schema": "https://docs.renovatebot.com/renovate-schema.json",
	"extends": [
		"config:best-practices",
		":maintainLockFilesWeekly"
	],
	"automerge": true,
	"autodiscover": true,
	"autodiscoverFilter": [
		"zemn-me/monorepo"
	],
	"allowScripts": true,
	"allowedCommands": [
		"^\\./sh/postUpgrade\\.sh$"
	],
	"configMigration": true,
	"platformAutomerge": true,
	"platformCommit": "enabled",
	"minimumReleaseAge": "3 days",
	"prConcurrentLimit": 0,
	"rollbackPrs": true,
	"rangeStrategy": "pin",
	"recreateWhen": "always",
	"commitBody": "{{#if logJSON.hasReleaseNotes}}{{#each logJSON.versions as |release|}}{{# if release.releaseNotes}}##### v{{{release.version}}} \n\n{{{release.releaseNotes.body}}}{{/if}}{{/each}}{{/if}}",
	"ignorePaths": [
		"**/monorepo/dist/**"
	],
	"gitIgnoredAuthors": [
		"zemnmez+renovate@gmail.com"
	],
	"customManagers": [
		{
			"customType": "regex",
			"description": "Renovate directives",
			"managerFilePatterns": [
				"/^MODULE.bazel$/",
				"/^WORKSPACE$/",
				"/^sh/bin/bazel$/"
			],
			"matchStrings": [
				"#\\s*renovate:\n#\\s*datasource\\s*=\\s*(?<datasource>(?:python-version|github-releases|github-tags))\n#\\s*versioning\\s*=\\s*(?<versioning>.*)\n#\\s*depName\\s*=\\s*(?<depName>.*)\n[^=]+=\\s*\"(?<currentValue>[^\"]*)\""
			],
			"datasourceTemplate": "{{{datasource}}}",
			"currentValueTemplate": "{{{currentValue}}}",
			"versioningTemplate": "{{{versioning}}}",
			"depNameTemplate": "{{{depName}}}"
		},
		{
			"customType": "regex",
			"description": "Renovate directives (git-refs digest)",
			"managerFilePatterns": [
				"/^MODULE.bazel$/",
				"/^WORKSPACE$/",
				"/^sh/bin/bazel$/"
			],
			"matchStrings": [
				"#\\s*renovate:\\n#\\s*datasource\\s*=\\s*git-refs\\n#\\s*versioning\\s*=\\s*(?<versioning>.*)\\n#\\s*depName\\s*=\\s*(?<depName>.*)\\n#\\s*refs-from\\s*=\\s*(?<refsFrom>.*)\\n[^=]+=\\s*\"(?<currentDigest>[^\"]*)\""
			],
			"datasourceTemplate": "git-refs",
			"currentValueTemplate": "{{{refsFrom}}}",
			"versioningTemplate": "{{{versioning}}}",
			"packageNameTemplate": "{{{depName}}}",
			"depNameTemplate": "{{{depName}}}"
		}
	],
	"customDatasources": {
		"johnvansickle_ffmpeg_old_releases": {
			"defaultRegistryUrlTemplate": "https://www.johnvansickle.com/ffmpeg/old-releases/",
			"format": "html"
		},
		"evermeet_ffmpeg_pub": {
			"defaultRegistryUrlTemplate": "https://evermeet.cx/pub/ffmpeg/",
			"format": "html"
		}
	},
	"packageRules": [
		{
			"matchDatasources": [
				"custom.johnvansickle_ffmpeg_old_releases"
			],
			"extractVersion": "^ffmpeg-(?<version>\\d+\\.\\d+(?:\\.\\d+)?)-(?:amd64|arm64|i686)-static\\.tar\\.xz$",
			"versioning": "loose"
		},
		{
			"matchDatasources": [
				"custom.evermeet_ffmpeg_pub"
			],
			"extractVersion": "^ffmpeg-(?<version>\\d+\\.\\d+(?:\\.\\d+)?)\\.zip$",
			"versioning": "loose"
		},
		{
			"matchManagers": [
				"bazel-module"
			],
			"matchPackageNames": [
				"rules_oci"
			],
			"allowedVersions": "!/1.8.0$/"
		},
		{
			"matchManagers": [
				"github-actions"
			],
			"matchPackageNames": [
				"jlumbroso/free-disk-space"
			],
			"versioning": "loose"
		},
		{
			"matchManagers": [
				"npm"
			],
			"matchPackageNames": [
				"twilio"
			],
			"enabled": false
		},
		{
			"matchManagers": [
				"cargo",
				"bazel",
				"custom.regex",
				"gomod",
				"pip-compile",
				"pip_requirements",
				"bazel",
				"bazel-module",
				"bazelisk"
			],
			"postUpgradeTasks": {
				"commands": [
					"./sh/postUpgrade.sh",
					"./sh/postUpgrade.sh"
				],
				"executionMode": "branch",
				"fileFilters": [
					"Cargo.Bazel.lock",
					"Cargo.toml",
					"cargo-bazel-lock.json",
					"**/*.ts",
					"go.mod",
					"MODULE.bazel",
					"MODULE.bazel.lock",
					"gazelle_python.yaml",
					"go.sum",
					"requirements.txt"
				],
				"recreateWhen": "always"
			}
		},
		{
			"groupName": "pulumi_cli",
			"matchPackageNames": [
				"/pulumi_cli_.*/"
			]
		},
		{
			"groupName": "chromedriver",
			"matchPackageNames": [
				"/com_googleapis_storage_chromedriver.*/"
			]
		}
	]
}
